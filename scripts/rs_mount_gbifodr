CREATE external schema redshift_spectrum
    FROM data catalog
    DATABASE dev
    IAM_ROLE 'arn:aws:iam::321942852011:role/service-role/AmazonRedshift-CommandsAccessRole-20231129T105842'
    CREATE external database if NOT exists;


CREATE EXTERNAL TABLE redshift_spectrum.occurrence_2023_11_01_parquet (
    gbifid	VARCHAR(max),
	species	VARCHAR(max),
	taxonrank	VARCHAR(max),
	scientificname	VARCHAR(max),
	countrycode	VARCHAR(max),
	stateprovince	VARCHAR(max),
	occurrencestatus	VARCHAR(max),
	publishingorgkey	VARCHAR(max),
	decimallatitude	DOUBLE PRECISION,
	decimallongitude	DOUBLE PRECISION,
	day	INT,
	month	INT,
	year	INT,
	taxonkey	INT,
	specieskey	INT,
	basisofrecord	VARCHAR(max)
    )
    STORED AS PARQUET
    LOCATION 's3://gbif-open-data-us-east-1/occurrence/2023-11-01/occurrence.parquet/';

SELECT * FROM SVV_EXTERNAL_DATABASES WHERE
databasename = 'dev';

SELECT COUNT(*) from dev.redshift_spectrum.occurrence_2023_11_01_parquet;
